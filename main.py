# Auto generated by LangBot Plugin SDK.
# Please refer to https://docs.langbot.app/en/plugin/dev/tutor.html for more details.
from __future__ import annotations

from langbot_plugin.api.definition.plugin import BasePlugin


class WecomAssistantPlugin(BasePlugin):


    def __init__(self):
        super().__init__()
        self._redis = None

    async def get_redis(self):
        if self._redis is None:
            import redis.asyncio as redis

            cfg = self.get_config()   
            redis_url = cfg.get("redis_url") or "redis://127.0.0.1:6379/0"

            
            self._redis = redis.from_url(
                redis_url,
                encoding="utf-8",
                decode_responses=True,
            )

        return self._redis

    async def on_unload(self):

        if self._redis is not None:
            await self._redis.close()
            self._redis = None

